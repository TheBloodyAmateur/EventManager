name: Generate Release Notes with AbsaOSS

on:
  push:
    branches:
      - main

jobs:
  generate_release_notes:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Generate Release Notes
        id: release_notes_generator
        uses: AbsaOSS/generate-release-notes@v0.2.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag-name: "v0.2.0"
          from-tag-name: "v0.1.0"
          chapters: |
            - {"title": "Breaking Changes 💥", "label": "breaking-change"}
            - {"title": "New Features 🎉", "label": "enhancement"}
            - {"title": "New Features 🎉", "label": "feature"}
            - {"title": "Bugfixes 🛠", "label": "bug"}

          duplicity-scope: 'service'
          duplicity-icon: '🔁'
          published-at: true
          skip-release-notes-labels: 'ignore-in-release'     # changing default value of label
          verbose: false
          release-notes-title: '[Rr]elease Notes:'

          warnings: false
          print-empty-chapters: false

      - name: Echo Generated Changelog
        run: echo "${{ steps.generate_notes.outputs.changelog }}"