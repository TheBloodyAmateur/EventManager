name: Generate Release Notes with AbsaOSS

on:
  push:
    branches:
      - main

jobs:
  generate_release_notes:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Generate Release Notes
        id: generate_notes
        uses: AbsaOSS/generate-release-notes@v0.2.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag-name: "v${{ github.run_number }}"
          chapters: |
            - {"title": "🚀 Features", "label": "feat"}
            - {"title": "🐛 Bug Fixes", "label": "fix"}
            - {"title": "📖 Docs", "label": "docs"}
            - {"title": "🛠️ Chores", "label": "chore"}
            - {"title": "🔄 Refactors", "label": "refactor"}

      - name: Echo Generated Changelog
        run: echo "Generated Changelog:\n${{ steps.generate_notes.outputs.release_notes }}"
